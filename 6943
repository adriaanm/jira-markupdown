It compiles if you parameterize the call to foo, as in foo[A, M](null.asInstanceOf[A]).
