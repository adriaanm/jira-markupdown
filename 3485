(In r21004) closes SI-3082, review by rytz
