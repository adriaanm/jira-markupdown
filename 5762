Close to, but not quite a duplicate of, scala/bug#3353.
