I can see now that this is a duplicate of scala/bug#2171, where I have added a short reproduction.
