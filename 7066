A good initial implementation was done by @jrudolph in https://github.com/scala/scala/pull/5487. A full implementation would move this logic into the type checker, but I think this could be tracked as a new issue when it comes up.
