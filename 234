maybe parametric extractors and type tags could implement this outside of the compiler
