(In r23433) Closes scala/bug#3932, scala/bug#1537. Review by extempore
