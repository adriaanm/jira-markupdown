(In r19762) Applied performance patch and test case from ijuma; closes scala/bug#2526.
