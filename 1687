(In r20827) closes scala/bug#1807,scala/bug#1821. review by community
