(In r20385) Closes scala/bug#2657, scala/bug#2789. Review by dragos.
