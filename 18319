See attached. The behaviour of the rewrite macro is dependent on the order of class Foo and object Consumer in Consumer.scala. If you put object Consumer before class Foo the error will disappear as the macro does not see the annotation.

In the macro code you can see an attempt to force potentially (uninitialized) infos of annotations. However, that doesn't help because annotations list is empty.

Also note that if you change annotated val {{k}} to be def then the problem disappears.
