(In r20292) Closes scala/bug#2819, scala/bug#2705, scala/bug#2805. Review by community.
