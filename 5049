I have overlooked another worst-case scenario: when two manifests are not equal. Unfortunately this means that matching on manifests cannot be salvaged without significantly improving the equals method.

A match block that tests equalify for several manifests in a critical spot is guaranteed to kill the performance.
