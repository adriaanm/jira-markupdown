Eclipse runs into some problem during build and project does not run because the main class file is missing. This is extremely urgent for me since it stops me from using Scala at all. I get two messages in the Eclipse error log:

1) Errors during build.
2) Problems occurred when invoking code from plug-in: "org.eclipse.core.resources".

I was not able to isolate a particular place in the code, or even the project which causes this. However, here is the stack trace, extracted from the second of the above error messages. Hopefully this will ring a bell:

{code}
java.util.NoSuchElementException: None.get
	at scala.None$$.get(Option.scala:150)
	at scala.None$$.get(Option.scala:148)
	at scala.tools.eclipse.ScalaPlugin$$ProjectImpl$$class.nscToLampion(ScalaPlugin.scala:280)
	at scala.tools.eclipse.Driver$$Project.nscToLampion(Driver.scala:16)
	at scala.tools.eclipse.BuildCompiler$$$$anon$$3.compileLate(BuildCompiler.scala:103)
	at scala.tools.nsc.symtab.SymbolLoaders$$SourcefileLoader.doComplete(SymbolLoaders.scala:307)
	at scala.tools.nsc.symtab.SymbolLoaders$$SymbolLoader.complete(SymbolLoaders.scala:80)
	at scala.tools.nsc.symtab.SymbolLoaders$$SymbolLoader.load(SymbolLoaders.scala:100)
	at scala.tools.nsc.symtab.Symbols$$Symbol.exists(Symbols.scala:386)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedSelect$$1(Typers.scala:2744)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3195)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3276)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedTypeConstructor(Typers.scala:3357)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedNew$$1(Typers.scala:2391)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3110)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3276)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedQualifier(Typers.scala:3333)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3193)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3276)
	at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$typedApply$$1$$1.apply(Typers.scala:2573)
	at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$typedApply$$1$$1.apply(Typers.scala:2573)
	at scala.tools.nsc.typechecker.Typers$$Typer.silent(Typers.scala:573)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedApply$$1(Typers.scala:2573)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3173)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3276)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3324)
	at scala.tools.nsc.typechecker.Typers$$Typer.computeType(Typers.scala:3366)
	at scala.tools.nsc.typechecker.Namers$$Namer.typeSig(Namers.scala:851)
	at scala.tools.nsc.typechecker.Namers$$Namer$$$$anonfun$$typeCompleter$$1.apply(Namers.scala:409)
	at scala.tools.nsc.typechecker.Namers$$Namer$$$$anonfun$$typeCompleter$$1.apply(Namers.scala:407)
	at scala.tools.nsc.typechecker.Namers$$$$anon$$1.complete(Namers.scala:1014)
	at scala.tools.nsc.symtab.Symbols$$Symbol.info(Symbols.scala:508)
	at scala.tools.nsc.symtab.Symbols$$Symbol.initialize(Symbols.scala:622)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:2995)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3276)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3313)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedStat$$1(Typers.scala:1549)
	at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$19.apply(Typers.scala:1594)
	at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$19.apply(Typers.scala:1594)
	at scala.List$$.loop$$1(List.scala:293)
	at scala.List$$.mapConserve(List.scala:310)
	at scala.List$$.loop$$1(List.scala:297)
	at scala.List$$.mapConserve(List.scala:310)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedStats(Typers.scala:1594)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedBlock(Typers.scala:1386)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3038)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3276)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3324)
	at scala.tools.nsc.typechecker.Typers$$Typer.transformedOrTyped(Typers.scala:3373)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedDefDef(Typers.scala:1324)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3014)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3276)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3313)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedStat$$1(Typers.scala:1549)
	at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$19.apply(Typers.scala:1594)
	at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$19.apply(Typers.scala:1594)
	at scala.List$$.loop$$1(List.scala:293)
	at scala.List$$.mapConserve(List.scala:310)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedStats(Typers.scala:1594)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedTemplate(Typers.scala:1174)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedModuleDef(Typers.scala:1072)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3008)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3276)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3313)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedStat$$1(Typers.scala:1549)
	at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$19.apply(Typers.scala:1594)
	at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$19.apply(Typers.scala:1594)
	at scala.List$$.loop$$1(List.scala:293)
	at scala.List$$.mapConserve(List.scala:310)
	at scala.List$$.loop$$1(List.scala:297)
	at scala.List$$.mapConserve(List.scala:310)
	at scala.List$$.loop$$1(List.scala:297)
	at scala.List$$.mapConserve(List.scala:310)
	at scala.List$$.loop$$1(List.scala:297)
	at scala.List$$.mapConserve(List.scala:310)
	at scala.List$$.loop$$1(List.scala:297)
	at scala.List$$.mapConserve(List.scala:310)
	at scala.List$$.loop$$1(List.scala:297)
	at scala.List$$.mapConserve(List.scala:310)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedStats(Typers.scala:1594)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3001)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3276)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3313)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedStat$$1(Typers.scala:1549)
	at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$19.apply(Typers.scala:1594)
	at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$19.apply(Typers.scala:1594)
	at scala.List$$.loop$$1(List.scala:293)
	at scala.List$$.mapConserve(List.scala:310)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedStats(Typers.scala:1594)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3001)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3276)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3313)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedStat$$1(Typers.scala:1549)
	at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$19.apply(Typers.scala:1594)
	at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$19.apply(Typers.scala:1594)
	at scala.List$$.loop$$1(List.scala:293)
	at scala.List$$.mapConserve(List.scala:310)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedStats(Typers.scala:1594)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3001)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3276)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3313)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedStat$$1(Typers.scala:1549)
	at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$19.apply(Typers.scala:1594)
	at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$19.apply(Typers.scala:1594)
	at scala.List$$.loop$$1(List.scala:293)
	at scala.List$$.mapConserve(List.scala:310)
	at scala.tools.nsc.typechecker.Typers$$Typer.typedStats(Typers.scala:1594)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3001)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3276)
	at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:3313)
	at scala.tools.nsc.typechecker.Analyzer$$typerFactory$$$$anon$$2.apply(Analyzer.scala:40)
	at scala.tools.nsc.Global$$GlobalPhase.applyPhase(Global.scala:262)
	at scala.tools.nsc.Global$$GlobalPhase$$$$anonfun$$run$$1.apply(Global.scala:243)
	at scala.tools.nsc.Global$$GlobalPhase$$$$anonfun$$run$$1.apply(Global.scala:243)
	at scala.Iterator$$class.foreach(Iterator.scala:395)
	at scala.collection.mutable.ListBuffer$$$$anon$$1.foreach(ListBuffer.scala:266)
	at scala.tools.nsc.Global$$GlobalPhase.run(Global.scala:243)
	at scala.tools.nsc.Global$$Run.compileSources(Global.scala:564)
	at scala.tools.nsc.Global$$Run.compile(Global.scala:649)
	at scala.tools.eclipse.BuildCompiler.build(BuildCompiler.scala:117)
	at scala.tools.eclipse.ScalaPlugin$$ProjectImpl$$class.build(ScalaPlugin.scala:293)
	at scala.tools.eclipse.Driver$$Project.build(Driver.scala:16)
	at lampion.eclipse.Builder.build(Builder.scala:85)
	at org.eclipse.core.internal.events.BuildManager$$2.run(BuildManager.java:624)
	at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)
	at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:166)
	at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:197)
	at org.eclipse.core.internal.events.BuildManager$$1.run(BuildManager.java:246)
	at org.eclipse.core.runtime.SafeRunner.run(SafeRunner.java:37)
	at org.eclipse.core.internal.events.BuildManager.basicBuild(BuildManager.java:249)
	at org.eclipse.core.internal.events.BuildManager.basicBuildLoop(BuildManager.java:302)
	at org.eclipse.core.internal.events.BuildManager.build(BuildManager.java:334)
	at org.eclipse.core.internal.events.AutoBuildJob.doBuild(AutoBuildJob.java:137)
	at org.eclipse.core.internal.events.AutoBuildJob.run(AutoBuildJob.java:235)
	at org.eclipse.core.internal.jobs.Worker.run(Worker.java:55)
{code}
Oh, forgot to mention: This is with todays daily build (5/26) of the plugin, but also occurred the same way with my previous version, which was weeks older. Eclipse version is the Europa  standard distribution, the PDE package, if I recall correctly, Version: 3.3.1.1 Build id: M20071023-1652.

Andreas


I updated eclipse to Ganymede M7, Version: 3.4.0. Build id: I20080502-0100.

Still the same problem.

Andreas

Very little we can do with this without more information.

From the look of the stack trace this is a compiler bug rather than a plugin bug (although the plugin should report the problem in a more friendly way), so could you please try and see if you can reproduce this problem outside of Eclipse using scalac from the command line.

Either way, a _small_ standalone .scala file which illustrates the problem will be extremely helpful.

I think it had to do with the eclipse project being out of synch with the filesystem, which seems consistent with your intuition. I started to try to isolate the problem last night, and it went away after a refresh. It is not clear to me how eclipse could be out of synch for so long, throughout many, many "Clean" and rebuild operations. Perhaps every clean should force a refresh? Anyway, that is an eclipse issue.

The problem is solved for me, but I think the plugin may still benefit from handling this situation more gracefully. A "None.get" error is equivalent to a Nullpointerexception and if it was my code, I would try to trace it upstream in the stack trace and nip it in the bud by handling the "None" case somewhere, if only with a more informative exception.
