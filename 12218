btw, this can be reincarnation of https://issues.scala-lang.org/browse/SI-9002
