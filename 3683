See scala/bug#3861 for a related issue and a workaround to this one.  (TL/DR: give B a self-type of A.)
