Oh, that was easier and more amusing than expected.

{code}
  private def currentIsTopLevel = {
    val r1 = !(currentClass.decodedName containsChar '$')
    val r2 = currentClass.toString.indexOf('$') < 0
    if (r1 != r2)
      println((r1, r2, currentClass.decodedName, currentClass.toString))
    r2
  }
{code}

{noformat}
(true,false,android.R@tr,android.R$attr)
(true,false,android.R@tr,android.R$attr)
{noformat}

I'll try to craft a test case for this and submit a PR shortly.
