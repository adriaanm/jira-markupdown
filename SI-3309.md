When porting Akka to 2.8.0RC1, the compiler crashes with this:

scala.tools.nsc.symtab.Types$$TypeError: reassignment to val
       at scala.tools.nsc.typechecker.Contexts$$Context.error(Contexts.scala:272)
       at scala.tools.nsc.typechecker.Infer$$Inferencer.error(Infer.scala:269)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedAssign$$1(Typers.scala:3166)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3872)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:4151)
       at scala.tools.nsc.typechecker.Duplicators$$BodyDuplicator.typed(Duplicators.scala:276)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedStat$$1(Typers.scala:2141)
       at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$20.apply(Typers.scala:2209)
       at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$20.apply(Typers.scala:2209)
       at scala.collection.immutable.List.loop$$1(List.scala:116)
       at scala.collection.immutable.List.mapConserve(List.scala:133)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedStats(Typers.scala:2209)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedBlock(Typers.scala:1966)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3842)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:4151)
       at scala.tools.nsc.typechecker.Duplicators$$BodyDuplicator.typed(Duplicators.scala:201)
       at scala.tools.nsc.typechecker.Typers$$Typer.transformedOrTyped(Typers.scala:4295)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedDefDef(Typers.scala:1848)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3815)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:4151)
       at scala.tools.nsc.typechecker.Duplicators$$BodyDuplicator.typed(Duplicators.scala:213)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedStat$$1(Typers.scala:2141)
       at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$20.apply(Typers.scala:2209)
       at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$20.apply(Typers.scala:2209)
       at scala.collection.immutable.List.loop$$1(List.scala:116)
       at scala.collection.immutable.List.mapConserve(List.scala:133)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedStats(Typers.scala:2209)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedBlock(Typers.scala:1966)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3842)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:4151)
       at scala.tools.nsc.typechecker.Duplicators$$BodyDuplicator.typed(Duplicators.scala:201)
       at scala.tools.nsc.typechecker.Typers$$Typer.transformedOrTyped(Typers.scala:4295)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedDefDef(Typers.scala:1848)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3815)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:4151)
       at scala.tools.nsc.typechecker.Duplicators$$BodyDuplicator.typed(Duplicators.scala:213)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedStat$$1(Typers.scala:2141)
       at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$20.apply(Typers.scala:2209)
       at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$20.apply(Typers.scala:2209)
       at scala.collection.immutable.List.loop$$1(List.scala:116)
       at scala.collection.immutable.List.mapConserve(List.scala:133)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedStats(Typers.scala:2209)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedTemplate(Typers.scala:1528)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedClassDef(Typers.scala:1309)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3806)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:4151)
       at scala.tools.nsc.typechecker.Duplicators$$BodyDuplicator.typed(Duplicators.scala:208)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedStat$$1(Typers.scala:2141)
       at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$20.apply(Typers.scala:2209)
       at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$20.apply(Typers.scala:2209)
       at scala.collection.immutable.List.loop$$1(List.scala:116)
       at scala.collection.immutable.List.mapConserve(List.scala:133)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedStats(Typers.scala:2209)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedBlock(Typers.scala:1966)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3842)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:4151)
       at scala.tools.nsc.typechecker.Duplicators$$BodyDuplicator.typed(Duplicators.scala:201)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedArg(Typers.scala:2215)
       at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$typedArgs$$3.apply(Typers.scala:2225)
       at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$typedArgs$$3.apply(Typers.scala:2224)
       at scala.collection.TraversableLike$$$$anonfun$$map$$1.apply(TraversableLike.scala:203)
       at scala.collection.TraversableLike$$$$anonfun$$map$$1.apply(TraversableLike.scala:203)
       at scala.collection.LinearSeqOptimized$$class.foreach(LinearSeqOptimized.scala:62)
       at scala.collection.immutable.List.foreach(List.scala:46)
       at scala.collection.TraversableLike$$class.map(TraversableLike.scala:203)
       at scala.collection.immutable.List.map(List.scala:46)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedArgs(Typers.scala:2224)
       at scala.tools.nsc.typechecker.Typers$$Typer.doTypedApply(Typers.scala:2423)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedApply$$1(Typers.scala:3373)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3997)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:4151)
       at scala.tools.nsc.typechecker.Duplicators$$BodyDuplicator.typed(Duplicators.scala:276)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedStat$$1(Typers.scala:2141)
       at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$20.apply(Typers.scala:2209)
       at scala.tools.nsc.typechecker.Typers$$Typer$$$$anonfun$$20.apply(Typers.scala:2209)
       at scala.collection.immutable.List.loop$$1(List.scala:116)
       at scala.collection.immutable.List.mapConserve(List.scala:133)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedStats(Typers.scala:2209)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedBlock(Typers.scala:1966)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3842)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:4151)
       at scala.tools.nsc.typechecker.Duplicators$$BodyDuplicator.typed(Duplicators.scala:201)
       at scala.tools.nsc.typechecker.Typers$$Typer.transformedOrTyped(Typers.scala:4295)
       at scala.tools.nsc.typechecker.Typers$$Typer.typedDefDef(Typers.scala:1848)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed1(Typers.scala:3815)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:4151)
       at scala.tools.nsc.typechecker.Duplicators$$BodyDuplicator.typed(Duplicators.scala:213)
       at scala.tools.nsc.typechecker.Typers$$Typer.typed(Typers.scala:4199)
       at scala.tools.nsc.typechecker.Duplicators.retyped(Duplicators.scala:32)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6.duplicateBody(SpecializeTypes.scala:1176)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6.transform(SpecializeTypes.scala:1056)
       at scala.tools.nsc.ast.Trees$$Transformer$$$$anonfun$$transformTrees$$1.apply(Trees.scala:832)
       at scala.tools.nsc.ast.Trees$$Transformer$$$$anonfun$$transformTrees$$1.apply(Trees.scala:832)
       at scala.collection.immutable.List.loop$$1(List.scala:116)
       at scala.collection.immutable.List.mapConserve(List.scala:133)
       at scala.collection.immutable.List.loop$$1(List.scala:120)
       at scala.collection.immutable.List.mapConserve(List.scala:133)
       at scala.collection.immutable.List.loop$$1(List.scala:120)
       at scala.collection.immutable.List.mapConserve(List.scala:133)
       at scala.tools.nsc.ast.Trees$$Transformer.transformTrees(Trees.scala:832)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6$$$$anonfun$$transform$$3.apply(SpecializeTypes.scala:1041)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6$$$$anonfun$$transform$$3.apply(SpecializeTypes.scala:1041)
       at scala.tools.nsc.ast.Trees$$Transformer.atOwner(Trees.scala:858)
       at scala.tools.nsc.transform.TypingTransformers$$TypingTransformer.atOwner(TypingTransformers.scala:36)
       at scala.tools.nsc.transform.TypingTransformers$$TypingTransformer.atOwner(TypingTransformers.scala:29)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6.transform(SpecializeTypes.scala:1041)
       at scala.tools.nsc.ast.Trees$$Transformer.transformTemplate(Trees.scala:834)
       at scala.tools.nsc.ast.Trees$$Transformer$$$$anonfun$$transform$$2.apply(Trees.scala:728)
       at scala.tools.nsc.ast.Trees$$Transformer$$$$anonfun$$transform$$2.apply(Trees.scala:727)
       at scala.tools.nsc.ast.Trees$$Transformer.atOwner(Trees.scala:858)
       at scala.tools.nsc.transform.TypingTransformers$$TypingTransformer.atOwner(TypingTransformers.scala:36)
       at scala.tools.nsc.transform.TypingTransformers$$TypingTransformer.atOwner(TypingTransformers.scala:29)
       at scala.tools.nsc.ast.Trees$$Transformer.transform(Trees.scala:726)
       at scala.tools.nsc.transform.TypingTransformers$$TypingTransformer.transform(TypingTransformers.scala:51)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6.transform(SpecializeTypes.scala:1139)
       at scala.tools.nsc.ast.Trees$$Transformer$$$$anonfun$$transformStats$$1.apply(Trees.scala:850)
       at scala.tools.nsc.ast.Trees$$Transformer$$$$anonfun$$transformStats$$1.apply(Trees.scala:848)
       at scala.collection.immutable.List.loop$$1(List.scala:116)
       at scala.collection.immutable.List.mapConserve(List.scala:133)
       at scala.tools.nsc.ast.Trees$$Transformer.transformStats(Trees.scala:848)
       at scala.tools.nsc.ast.Trees$$Transformer.transform(Trees.scala:760)
       at scala.tools.nsc.transform.TypingTransformers$$TypingTransformer.transform(TypingTransformers.scala:51)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6.transform(SpecializeTypes.scala:1139)
       at scala.tools.nsc.ast.Trees$$Transformer$$$$anonfun$$transformTrees$$1.apply(Trees.scala:832)
       at scala.tools.nsc.ast.Trees$$Transformer$$$$anonfun$$transformTrees$$1.apply(Trees.scala:832)
       at scala.collection.immutable.List.loop$$1(List.scala:116)
       at scala.collection.immutable.List.mapConserve(List.scala:133)
       at scala.tools.nsc.ast.Trees$$Transformer.transformTrees(Trees.scala:832)
       at scala.tools.nsc.ast.Trees$$Transformer.transform(Trees.scala:798)
       at scala.tools.nsc.transform.TypingTransformers$$TypingTransformer.transform(TypingTransformers.scala:51)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6.transform(SpecializeTypes.scala:1139)
       at scala.tools.nsc.ast.Trees$$Transformer$$$$anonfun$$transformTrees$$1.apply(Trees.scala:832)
       at scala.tools.nsc.ast.Trees$$Transformer$$$$anonfun$$transformTrees$$1.apply(Trees.scala:832)
       at scala.collection.immutable.List.loop$$1(List.scala:116)
       at scala.collection.immutable.List.mapConserve(List.scala:133)
       at scala.collection.immutable.List.loop$$1(List.scala:120)
       at scala.collection.immutable.List.mapConserve(List.scala:133)
       at scala.tools.nsc.ast.Trees$$Transformer.transformTrees(Trees.scala:832)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6$$$$anonfun$$transform$$3.apply(SpecializeTypes.scala:1041)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6$$$$anonfun$$transform$$3.apply(SpecializeTypes.scala:1041)
       at scala.tools.nsc.ast.Trees$$Transformer.atOwner(Trees.scala:858)
       at scala.tools.nsc.transform.TypingTransformers$$TypingTransformer.atOwner(TypingTransformers.scala:36)
       at scala.tools.nsc.transform.TypingTransformers$$TypingTransformer.atOwner(TypingTransformers.scala:29)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6.transform(SpecializeTypes.scala:1041)
       at scala.tools.nsc.ast.Trees$$Transformer.transformTemplate(Trees.scala:834)
       at scala.tools.nsc.ast.Trees$$Transformer$$$$anonfun$$transform$$2.apply(Trees.scala:728)
       at scala.tools.nsc.ast.Trees$$Transformer$$$$anonfun$$transform$$2.apply(Trees.scala:727)
       at scala.tools.nsc.ast.Trees$$Transformer.atOwner(Trees.scala:858)
       at scala.tools.nsc.transform.TypingTransformers$$TypingTransformer.atOwner(TypingTransformers.scala:36)
       at scala.tools.nsc.transform.TypingTransformers$$TypingTransformer.atOwner(TypingTransformers.scala:29)
       at scala.tools.nsc.ast.Trees$$Transformer.transform(Trees.scala:726)
       at scala.tools.nsc.transform.TypingTransformers$$TypingTransformer.transform(TypingTransformers.scala:51)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6.transform(SpecializeTypes.scala:1139)
       at scala.tools.nsc.ast.Trees$$Transformer$$$$anonfun$$transformStats$$1.apply(Trees.scala:850)
       at scala.tools.nsc.ast.Trees$$Transformer$$$$anonfun$$transformStats$$1.apply(Trees.scala:848)
       at scala.collection.immutable.List.loop$$1(List.scala:116)
       at scala.collection.immutable.List.mapConserve(List.scala:133)
       at scala.tools.nsc.ast.Trees$$Transformer.transformStats(Trees.scala:848)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6$$$$anonfun$$transform$$2.apply(SpecializeTypes.scala:1028)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6$$$$anonfun$$transform$$2.apply(SpecializeTypes.scala:1026)
       at scala.tools.nsc.ast.Trees$$Transformer.atOwner(Trees.scala:858)
       at scala.tools.nsc.transform.TypingTransformers$$TypingTransformer.atOwner(TypingTransformers.scala:36)
       at scala.tools.nsc.transform.SpecializeTypes$$$$anon$$6.transform(SpecializeTypes.scala:1026)
       at scala.tools.nsc.transform.SpecializeTypes$$SpecializationTransformer$$$$anonfun$$transform$$5.apply(SpecializeTypes.scala:1377)
       at scala.tools.nsc.transform.SpecializeTypes$$SpecializationTransformer$$$$anonfun$$transform$$5.apply(SpecializeTypes.scala:1376)
       at scala.tools.nsc.symtab.SymbolTable.atPhase(SymbolTable.scala:104)
       at scala.tools.nsc.transform.SpecializeTypes$$SpecializationTransformer.transform(SpecializeTypes.scala:1376)
       at scala.tools.nsc.ast.Trees$$Transformer.transformUnit(Trees.scala:851)
       at scala.tools.nsc.transform.Transform$$Phase.apply(Transform.scala:31)
       at scala.tools.nsc.Global$$GlobalPhase$$$$anonfun$$applyPhase$$1.apply(Global.scala:272)
       at scala.tools.nsc.Global$$GlobalPhase$$$$anonfun$$applyPhase$$1.apply(Global.scala:272)
       at scala.tools.nsc.reporters.Reporter.withSource(Reporter.scala:49)
       at scala.tools.nsc.Global$$GlobalPhase.applyPhase(Global.scala:272)
       at scala.tools.nsc.Global$$GlobalPhase$$$$anonfun$$run$$1.apply(Global.scala:248)
       at scala.tools.nsc.Global$$GlobalPhase$$$$anonfun$$run$$1.apply(Global.scala:248)
       at scala.collection.Iterator$$class.foreach(Iterator.scala:627)
       at scala.collection.mutable.ListBuffer$$$$anon$$1.foreach(ListBuffer.scala:305)
       at scala.tools.nsc.Global$$GlobalPhase.run(Global.scala:248)
       at scala.tools.nsc.Global$$Run.compileSources(Global.scala:729)
       at scala.tools.nsc.Global$$Run.compile(Global.scala:815)
       at xsbt.CompilerInterface.run(CompilerInterface.scala:81)
       at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
       at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
       at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
       at java.lang.reflect.Method.invoke(Method.java:597)
       at xsbt.AnalyzingCompiler.call(AnalyzingCompiler.scala:40)
       at xsbt.AnalyzingCompiler.apply(AnalyzingCompiler.scala:18)
       at sbt.Compile.processScala(Compile.scala:76)
       at sbt.CompilerCore$$$$anonfun$$1.apply(Compile.scala:27)
       at sbt.CompilerCore$$$$anonfun$$1.apply(Compile.scala:27)
       at sbt.CompilerCore$$$$anonfun$$process$$1$$1.apply(Compile.scala:22)
       at sbt.CompilerCore$$$$anonfun$$process$$1$$1.apply(Compile.scala:22)
       at sbt.CompilerCore$$$$anonfun$$doCompile$$3.apply(Compile.scala:45)
       at sbt.CompilerCore$$$$anonfun$$doCompile$$3.apply(Compile.scala:42)
       at scala.Option.orElse(Option.scala:102)
       at sbt.CompilerCore.doCompile(Compile.scala:41)
       at sbt.CompilerCore.apply(Compile.scala:29)
       at sbt.AbstractCompileConditional.run$$1(Conditional.scala:341)
       at sbt.AbstractCompileConditional$$$$anonfun$$3.apply(Conditional.scala:344)
       at sbt.AbstractCompileConditional$$$$anonfun$$3.apply(Conditional.scala:344)
       at sbt.classfile.Analyze$$.apply(Analyze.scala:110)
       at sbt.AbstractCompileConditional.execute(Conditional.scala:344)
       at sbt.Conditional$$class.run(Conditional.scala:43)
       at sbt.AbstractCompileConditional.run(Conditional.scala:231)
       at sbt.BasicScalaProject.sbt$$BasicScalaProject$$$$doCompile(DefaultProject.scala:257)
       at sbt.BasicScalaProject$$$$anonfun$$testCompileAction$$1.apply(DefaultProject.scala:272)
       at sbt.BasicScalaProject$$$$anonfun$$testCompileAction$$1.apply(DefaultProject.scala:272)
       at sbt.TaskManager$$Task.invoke(TaskManager.scala:62)
       at sbt.impl.RunTask.doRun$$1(RunTask.scala:77)
       at sbt.impl.RunTask.runTask(RunTask.scala:85)
       at sbt.impl.RunTask.sbt$$impl$$RunTask$$$$runIfNotRoot(RunTask.scala:60)
       at sbt.impl.RunTask$$$$anonfun$$runTasksExceptRoot$$2.apply(RunTask.scala:48)
       at sbt.impl.RunTask$$$$anonfun$$runTasksExceptRoot$$2.apply(RunTask.scala:48)
       at sbt.Distributor$$Run$$Worker$$$$anonfun$$2.apply(ParallelRunner.scala:131)
       at sbt.Distributor$$Run$$Worker$$$$anonfun$$2.apply(ParallelRunner.scala:131)
       at sbt.Control$$.trapUnit(Control.scala:19)
       at sbt.Distributor$$Run$$Worker.run(ParallelRunner.scala:131)
Narrowing it down the crash came from having a lazy val within a ScalaTest Spec test. Here's a smaller version that produces the same:

{code}
% cat Test.scala
import org.scalatest.Spec
import org.scalatest.matchers.ShouldMatchers

class Test extends Spec with ShouldMatchers {

  describe("Test") {
    it("should compile") {
      lazy val value = 3
      value should be(3)
    }
  }
}

% scalac -version
Scala compiler version 2.8.0.RC1 -- Copyright 2002-2010, LAMP/EPFL

% scalac -cp scalatest-1.0.1-for-scala-2.8.0.RC1-SNAPSHOT.jar Test.scala
Exception in thread "main" scala.tools.nsc.symtab.Types$$TypeError: reassignment to val
...
{code}
Here's a simpler way to reproduce the bug:

{code}
Welcome to Scala version 2.8.0.RC1 (Java HotSpot(TM) Client VM, Java 1.6.0_16).                                                      
Type in expressions to have them evaluated.                                                                                          
Type :help for more information.                                                                                                     

scala> def test[U](block: => U): Unit = { block }
test: [U](block: => U)Unit                       

scala> test { lazy val x = 1 }
Exception in thread "main" scala.tools.nsc.symtab.Types$$TypeError: reassignment to val
...
{code}
