Additionally, it would make sense to add some check to the detection code for a command line argument so that the task support choice can be overridden and therefore all code paths can be tested.
One example of issues caused by not being able to test this code is SI-7236.
