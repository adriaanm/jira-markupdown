(In r21923) Overhauled sequence length logic in the pattern matcher.  Removes
unnecessary boxing and a few varieties of wrongness.

Closes SI-3395, SI-3150, SI-2958, SI-2945, SI-2187.  No review.
