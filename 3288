(In r21923) Overhauled sequence length logic in the pattern matcher.  Removes
unnecessary boxing and a few varieties of wrongness.

Closes scala/bug#3395, scala/bug#3150, scala/bug#2958, scala/bug#2945, scala/bug#2187.  No review.
