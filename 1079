This is essentially a dupe of scala/bug#925.
