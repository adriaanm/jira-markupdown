(In r21675) close scala/bug#3338, close scala/bug#3334, close scala/bug#3345. review by community.
