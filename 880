One use of the comparison function was incorrect (the inverse should have been used). So you have not gone mad ;)

Patch attached.
