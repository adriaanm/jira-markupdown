This is in part a duplicate of SI-1342. After the fix of SI-1342 this still gave a compile tyime error, which is now fixed (for 2.8) in r19656.
