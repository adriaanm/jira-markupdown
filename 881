Duplicate of scala/bug#998 and scala/bug#1007. Should work in the trunk, though.
