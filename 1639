This is a duplicate of SI-715, which I already updated with this code.  Also, please don't use pastebin references in bug reports, as they are ephemeral and trac will be here a long time.
