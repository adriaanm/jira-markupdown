The doc part of this ticket depends on scala/bug#3484.
