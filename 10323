I've just added another commit to that branch that fixes `f4`. Seems like a pretty fundamental assumption in {{TypeRef#baseTypeSeqImpl}} was broken: the symbols BTS can't be mapped element wise if viewing it from a prefix makes an abstract type concrete and contributes new base types. 

Both changes in the branch are needed; I was hoping the second would subsume the first. Still feels a bit ad hoc, so I'd appreciate if you could try to poke holes in it, Paul.
