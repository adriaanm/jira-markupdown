This is a variation on, but still a duplicate of, scala/bug#1466.
