This seems similar to scala/bug#7645 (especially the [2nd comment|https://issues.scala-lang.org/browse/SI-7645?focusedCommentId=68798]).
