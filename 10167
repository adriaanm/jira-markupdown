Is the issue that the inferred result type is too narrow?  That it would be a nice improvement if names 'map' and 'flatMap' were special-cased so that this.type is preferred?

Later, I supposed that one might just say: Please infer a type that survives the variance check.  But not Any.

Otherwise, it works as advertized.  There is no "obvious return type."

Footnote, it looks like "main.scala" may not belong in the type reported in the error.
