As a guy who has tried to make these things faster a number of times, I can tell you there is even more to consider, among which is that IntRef is vastly less expensive than one might suppose.  At least it was when I measured.  I'm sorry I don't have good records of the things I have tried.
