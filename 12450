I hope to add a commit at https://github.com/scala/scala/pull/5402

It seems to me like an important use case that should be technically feasible. But I haven't looked at it yet.
