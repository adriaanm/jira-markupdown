Making a small edit to your example reproduces the slowdown:
{code}
-  type Upcast = IndexedSeq[String]
+  type Upcast = Seq[String]
{code}

The runtime with an upcast to Seq is:
{noformat}
55178.384 / 100001
55987.473 / 100001
...
{noformat}

At some level it makes sense that you must declare something as an IndexedSeq to get O(1)ish behaviour. But... was this intended?
