(In r24740) Closes SI-4275. Review by plocinic since this is the first code that treats errors as trees. As discussed, it would be good to use this pattern more systematically.
