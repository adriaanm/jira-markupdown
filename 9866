See also SI-3120. I think the fix for this ticket needs to extend the approach taken for that one.
