@melezov thanks a lot for your patch! I refined it a bit and submitted it in https://github.com/scala/scala/pull/4944
