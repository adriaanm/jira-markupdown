You can do it by writing the method you just sketched.  If you want, you can throw in macros as well, although I don't see why you'd need them.
