I though that `if (v1.size == 0) None else Some(v1.iterator.next())` is where the race condition comes from, no? I mean, both `size` and `iterator` here result in calling the iterator separately.

Seems like you would have to create the snapshot in the `new AbstractIterable ...` only once, and use that for the iterator.
