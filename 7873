Work in progress: https://github.com/magarciaEPFL/scala/compare/ticket-SI-5985
