Duplicate of scala/bug#4332. I've added this test case to the comments of that bug.
