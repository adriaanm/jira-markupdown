Fix originally proposed for scala/bug#5024:  https://github.com/adriaanm/scala/commits/ticket-5024, see also scala/bug#4577.
