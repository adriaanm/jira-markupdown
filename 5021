(In r24224) Closes SI-3986 plus some cleanup. no review
