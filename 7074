BTW, it's related to https://issues.scala-lang.org/browse/SI-3506, which never got a self contained test case.
