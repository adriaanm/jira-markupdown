Probably needs to be disallowed in the return type as well:

{code:lang=java}
object D {
  def main(args: Array[String]) {
    val a = new { def y[T](x: T): X[T] = new X(x) }
    val t = a.y(3).i + 1
    println(t)
  }
}

class X[T](val i: T) extends AnyVal
```scala

```
java.lang.ClassCastException: java.lang.Integer cannot be cast to X
   at D$.main(D.scala:4)
   at D.main(D.scala)
{code}
