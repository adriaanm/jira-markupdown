At some point I implemented the logic for this, but the real obstacle is jline.  It has enough trouble figuring out where the cursor is under the simplest conditions.  Start throwing big multiline blocks into the history and it breaks down in tears.  Would love to see this and scala/bug#2547 addressed by the community.
