Not sure if this helps, but what I ended out doing in my code is define a method in class A1 to compute the anonymous function passed in the constructor to D, like so:
```scala
class A1 {
  ...
  def ff(f: (Int, Int)=>A11): (Int, Int, Int, Int)=>Option[B.B1] =
    (i, j, id, rep) => {
      for (x <- Some(f(i, j)); s<-x.a11) yield new B.B1(x.i, x.j) {}
    }
  class A12(f: (Int, Int)=>A11) extends D(ff(f))
}
```

That averted the crash.
