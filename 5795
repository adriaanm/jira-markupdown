~~github.com/scala/scala/pull/4659~~ part of https://github.com/scala/scala/pull/4725
