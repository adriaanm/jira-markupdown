(In r21077) Closes SI-3015. Review by moors (it's his patch).
