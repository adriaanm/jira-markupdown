(In r21077) Closes scala/bug#3015. Review by moors (it's his patch).
