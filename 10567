Work in progress here:

* https://github.com/demobox/scala/commit/2621c41f24323241cd260a3b8accd9f7ec14ce28
* https://github.com/demobox/scala/commit/cd0a216dae0b0cc3d345ecf2063360e048468278
