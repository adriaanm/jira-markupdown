(In r21675) close SI-3338, close SI-3334, close SI-3345. review by community.
