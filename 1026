Sadness: still not right, and also caused scala/bug#1842.
