(In r20624) Closes SI-2653, SI-2652, SI-2556. The last one required more sophisticated mechanism for detecting invalid references to inherited members, but at least it doesn't seem to cause unnecessary recompilations. 
