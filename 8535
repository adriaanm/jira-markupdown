I don't know; I didn't mean to suggest there's no bug here.  The existential type looks malformed - there's no bound on the clause, just the val.  I don't have the spare brainpower right now to convince myself they should be the same type, but I can believe it.  If the code can be simplified at all, it wouldn't hurt.
