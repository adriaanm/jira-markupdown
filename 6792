So, if I assign an AST tree to an existing key in a map, it will *traverse all AST* just to check whether it is equal or not to the exiting value? That looks extremely suboptimal to me. Or are you just doing reference equality checks? I tried to check what your patch does, but you did not submit a patch -- you submitted the whole edited file. Don't do that, please -- diff was invented 40 years ago, so there's no reason not to use it.
