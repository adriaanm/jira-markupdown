This looks related
{code}
object Bug {
  object Bar {
    def unapply(x: AnyRef): Option[x.type] = x match {
      case _    => Some(x)
    }
  }

  def foo(z: AnyRef) {
    z match {
      case Bar(_) => ()
      case _ => ()
    }
  }
}
{code}

gives:
{code}
error: error during expansion of this match (this is a scalac bug).
The underlying error was: type mismatch;
 found   : Option[<unapply-selector>.type]
 required: Option[x.type]
    z match {
      ^
one error found
{code}
