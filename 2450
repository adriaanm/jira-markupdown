Fixing this ticket will also fix SI-2581. Even simpler test case is:
{code}
class A
class B(val a: A)

scalac -Xresident
nsc> src/AB.scala
Remove A
nsc> src/AB.scala
// no errors
{code}
