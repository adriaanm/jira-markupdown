(In r22253) Closes scala/bug#3174 and scala/bug#3560. Review by moors.
