(In r22253) Closes SI-3174 and SI-3560. Review by moors.
