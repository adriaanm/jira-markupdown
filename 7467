Here's an attempt to fix this.

  https://github.com/scala/scala/pull/627
