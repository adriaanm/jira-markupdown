One could argue that the problem lies in the refinement with A[C]:

{code}
class C extends B with A[C]
{code}

That's the same feature that interacts with type refinement for covariant GADTs.
