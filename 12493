re: the use of a random-code generator here, see my remarks on scala/bug#9955
