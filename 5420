It looks like a bug that occurs when a listing crosses a page break. There's nothing special about the listing itself, and if I put a \clearpage before it, the thing builds fine. Give that, the least bad thing to do right now might be to put a \clearpage before any listing that has the problem. Additionally, for longer listings, it might be better to put them inside a float so that they won't possibly cross a page boundary.

To prevent people from following a dead end, I can also add that surrounding the listing with \begin{samepage}...\end{samepage} didn't fix the problem.


The ideal fix would be in the Listings package itself. I don't have time right now to look into that, but perhaps someone else does. Also, I'll email Brooks Moses, the most recent maintainer I can find for the Listings package, and include a link to this bug report and minified sample file.
