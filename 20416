`scala.util.matching.Regex.replaceAllIn` has some problems in handling "$" (the dollar sign) in the input string. In some cases, it treats $3 (for example) in the input as a capture group replacement / back-reference. To do so is incorrect.

I'll walk you through some examples, starting with examples that work. Also, please notice the variation in behavior.

I'll start with a pattern I used in some NLP processing to strip 's from possessive tokens.

val pattern = """([^']+)'s""".r
pattern: scala.util.matching.Regex = ([^']+)'s

scala> pattern.replaceAllIn("Bob's", m => m.group(1) )
res0: String = Bob

scala> pattern.replaceAllIn("Frank", m => m.group(1) )
res1: String = Frank

scala> pattern.replaceAllIn("$300", m => m.group(1) )
res2: String = $300

scala> pattern.replaceAllIn("$300's", m => m.group(1) )
java.lang.IndexOutOfBoundsException: No group 3
  at java.util.regex.Matcher.start(Matcher.java:375)
  at java.util.regex.Matcher.appendReplacement(Matcher.java:880)
  at scala.util.matching.Regex$Replacement.replace(Regex.scala:861)
  at scala.util.matching.Regex$Replacement.replace$(Regex.scala:861)
  at scala.util.matching.Regex$MatchIterator$$anon$1.replace(Regex.scala:839)
  at scala.util.matching.Regex.$anonfun$replaceAllIn$1(Regex.scala:491)
  at scala.collection.Iterator.foreach(Iterator.scala:929)
  at scala.collection.Iterator.foreach$(Iterator.scala:929)
  at scala.collection.AbstractIterator.foreach(Iterator.scala:1406)
  at scala.util.matching.Regex.replaceAllIn(Regex.scala:491)
  ... 29 elided

Above, please note that the first argument to `pattern.replaceAllIn` is an input string. There should be no handling of capture groups (e.g. $2) in an input string.

scala> pattern.replaceAllIn("$x300's", m => m.group(1) )
java.lang.IllegalArgumentException: Illegal group reference
  at java.util.regex.Matcher.appendReplacement(Matcher.java:857)
  at scala.util.matching.Regex$Replacement.replace(Regex.scala:861)
  at scala.util.matching.Regex$Replacement.replace$(Regex.scala:861)
  at scala.util.matching.Regex$MatchIterator$$anon$1.replace(Regex.scala:839)
  at scala.util.matching.Regex.$anonfun$replaceAllIn$1(Regex.scala:491)
  at scala.collection.Iterator.foreach(Iterator.scala:929)
  at scala.collection.Iterator.foreach$(Iterator.scala:929)
  at scala.collection.AbstractIterator.foreach(Iterator.scala:1406)
  at scala.util.matching.Regex.replaceAllIn(Regex.scala:491)
  ... 29 elided

scala> pattern.replaceAllIn("$600's", m => m.group(1) )
java.lang.IndexOutOfBoundsException: No group 6
  at java.util.regex.Matcher.start(Matcher.java:375)
  at java.util.regex.Matcher.appendReplacement(Matcher.java:880)
  at scala.util.matching.Regex$Replacement.replace(Regex.scala:861)
  at scala.util.matching.Regex$Replacement.replace$(Regex.scala:861)
  at scala.util.matching.Regex$MatchIterator$$anon$1.replace(Regex.scala:839)
  at scala.util.matching.Regex.$anonfun$replaceAllIn$1(Regex.scala:491)
  at scala.collection.Iterator.foreach(Iterator.scala:929)
  at scala.collection.Iterator.foreach$(Iterator.scala:929)
  at scala.collection.AbstractIterator.foreach(Iterator.scala:1406)
  at scala.util.matching.Regex.replaceAllIn(Regex.scala:491)
  ... 29 elided

Note the variation of behavior here (no error)

scala> pattern.replaceAllIn("$1200's", m => m.group(1) )
res7: String = $1200200
```
