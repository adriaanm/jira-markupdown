Since this happens so randomly it was a prime candidate for some JIT related JVM bug.
I ran the code using -XX:+PrintCompilation and there is a clear pattern:
* Main$$anonfun$main$1$$anonfun$1::apply v4 is compiled
* Main$$anonfun$main$1$$anonfun$1::apply v3 is made not entrant

And at the point of v3 being made not entrant it always crashes the JVM or produces an incorrect result.
