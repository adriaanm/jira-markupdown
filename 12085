Something along the lines of shapeless's `Typeable` would do a better job here.
