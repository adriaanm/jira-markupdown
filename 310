See also SI-1713 for a simpler example.
