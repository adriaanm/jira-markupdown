(In r20376) Closes SI-2793, SI-2651, SI-2650, SI-2653. Review by dragos.
