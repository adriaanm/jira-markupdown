Note that decreasing either `N` or `M` to `1400` is enough to get this code to work. I'd venture there's an `Int` wrap-around happening somewhere, or, perhaps, just a memory exaustion of some type being masked by the out of range errors.
