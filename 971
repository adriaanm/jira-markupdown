I was thinking: if the script contains only object/class/trait definitions, we could generate:

{code}
object O1
object O2 { def main(args: Array[String]) {}} }
class C

// Generated
object Main {
  def main(args: Array[String]) = {
    runMain
  }
}
{code}

Where {{runMain}} is a macro that inspects the current compilation unit to find an one-and-only-one object with a main (other than Main itself), and then delegates to that.

This would then work for classes that extends {{App}}, too.
