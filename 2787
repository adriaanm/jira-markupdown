(In r20376) Closes scala/bug#2793, scala/bug#2651, scala/bug#2650, scala/bug#2653. Review by dragos.
