Attached is a naive attempt to fix the issue.  This reverses the order of the operands in the equality check to align with section 8.1.5 in the spec, which says == is called on the pattern, not the thing being matched (scrutinee?).  Another solution is to modify the spec to say that the behavior is unspecified when the equals contract is broken, as it is here.

Note that 1) and 2) of the first comment on SI-785 are fixed by this patch (same issue), although not in the way requested by the comment.
