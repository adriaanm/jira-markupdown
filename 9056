I think this is a variation of SI-6666, see my test case in the comments:

https://issues.scala-lang.org/browse/SI-6666?focusedCommentId=61462&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-61462

The sane thing to do is forbid such constructs, but I haven't quite figured out where to put the check.
