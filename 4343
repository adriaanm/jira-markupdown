(In r22334) A wholesale reversion of the pattern matcher to r21939, motivated
by the appearance of SI-3578.  Closes SI-3578, reopens SI-2800, SI-3050.
Review by moors.  (I can't keep saying "no review" when every
move I make in here seems to break something.)
