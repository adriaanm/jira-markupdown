(In r22334) A wholesale reversion of the pattern matcher to r21939, motivated
by the appearance of scala/bug#3578.  Closes scala/bug#3578, reopens scala/bug#2800, scala/bug#3050.
Review by moors.  (I can't keep saying "no review" when every
move I make in here seems to break something.)
